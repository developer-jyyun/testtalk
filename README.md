
<p align="center"> 
  <img src="https://github.com/Toy2-team10/Talkhaja/assets/65649035/3edb727a-e9b9-4821-bf14-b5582e28a0e9" alt="Talkhaja logo"/>
</p>

### <p align="center">함께 나누어 더 즐거운 여행 수다, Talk하자!</p>

### <p align="center">Talkhaja에서 유저들과 함께 여러분들의 여정을 공유하고 즐기세요.</p>

##

## :clap: 10조 Contributors

<table>
    <tr>
        <td align="center"><img alt="avatar" src="https://github.com/jseo9732.png" width="100"></td>
        <td align="center"><img alt="avatar" src="https://github.com/moana16.png" width="100"></td>
        <td align="center"><img alt="avatar" src="https://github.com/junkue20.png" width="100"></td>
        <td align="center"><img alt="avatar" src="https://github.com/Eojoonhyuk.png" width="100"></td>
        <td align="center"><img alt="avatar" src="https://github.com/developer-jyyun.png" width="100"></td>
    </tr>
    <tr>
        <td align="center"><a href="https://github.com/jseo9732">서지수</a></td>
        <td align="center"><a href="https://github.com/moana16">김지민</a></td>
        <td align="center"><a href="https://github.com/junkue20">박준규</a></td>
        <td align="center"><a href="https://github.com/Eojoonhyuk">어준혁</a></td>
        <td align="center"><a href="https://github.com/Eojoonhyuk">윤지영</a></td>
    </tr>
</table>

## :computer: 커밋 컨벤션

| 명칭     | 의미                                   |
| -------- | -------------------------------------- |
| Feat     | 새로운 기능 추가                       |
| Fix      | 버그 수정                              |
| Docs     | 문서 수정                              |
| Style    | 코드 포맷팅, 세미콜론 누락             |
| Refactor | 코드 리팩토링                          |
| Test     | 테스트 코드, 리팩토링 테스트 코드 추가 |
| Chore    | 빌드 업무 수정, 패키지 매니저 수정     |

## :file_folder: 폴더 구조

```
📦
├─ public - static 파일
├─ src
│  ├─ assets - 이미지
│  ├─ components - 공통 컴포넌트 (nav, sidebar...)
│  ├─ pages - 페이지별 컴포넌트
│  │  └─ MainPage
│  │  └─ ...
│  ├─ recoil - 상태관리 파일 폴더
│  │  ├─ atoms
│  │  └─ selectors
│  ├─ styled - styled-components (CSS)
│  ├─ types - TS interface, type 등 타입 관련
│  └─ utils - 공통 함수
└─ ©generated by Project Tree Generator

```

## 🛢️ Stack

### 🛠️ Tools

<p align="left">
  <img src="https://img.shields.io/badge/figma-F24E1E?style=for-the-badge&logo=figma&logoColor=white">
  <img src="https://img.shields.io/badge/vscode-007ACC?style=for-the-badge&logo=visualstudiocode&logoColor=white">
  <img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
</p>

### 🤝 Collaboration

<p align="left">
  <img src="https://img.shields.io/badge/notion-ffffff?style=for-the-badge&logo=notion&logoColor=black">
  <img src="https://img.shields.io/badge/Jira-0052CC?style=for-the-badge&logo=Jira&logoColor=white">
  <img src="https://img.shields.io/badge/slack-4A154B?style=for-the-badge&logo=slack&logoColor=white">
  <img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
</p>

### 🎨 Frontend Stacks

<p align="left">
  <img src="https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=React&logoColor=black"/>
  <img src="https://img.shields.io/badge/Typescript-3178C6?style=for-the-badge&logo=typescript&logoColor=white"/>
  <img src="https://img.shields.io/badge/next.js-000000?style=for-the-badge&logo=nextdotjs&logoColor=white"/>
  <img src="https://img.shields.io/badge/sass-CC6699?style=for-the-badge&logo=sass&logoColor=white"/>
  <br/>
  <img src="https://img.shields.io/badge/recoil-007AF4?style=for-the-badge&logo=recoil&logoColor=black"/>
  <img src="https://img.shields.io/badge/vercel-ffffff?style=for-the-badge&logo=vercel&logoColor=black"/>
  <img src="https://img.shields.io/badge/socket.io-010101?style=for-the-badge&logo=socket.io&logoColor=white">
  <img src="https://img.shields.io/badge/Eslint-4B32C3?logo=eslint&logoColor=white&style=for-the-badge"/>
  <img src="https://img.shields.io/badge/Prettier-F7B93E?logo=prettier&logoColor=black&style=for-the-badge"/>
</p>

### ⚙️ Backend Stacks

<p align="left">
  <img src="https://img.shields.io/badge/Firebase-FFCA28?style=for-the-badge&logo=firebase&logoColor=black"/>
</p>

## Git Branches

- main: 배포용 브랜치
- develop : 개발용 브랜치
- TALK 개별 개발용 브랜치

## 개인별 작업 내용

<!-- -------------------------- 지수님 자리 -------------------------- -->
<details>
<summary>서지수</summary>

## 작업 세부내용

- ~~설정.
- ~~시도.

## ~~ 기능 구현

- ~~ 할 수 있는 기능 추가.

|                                     로그인 시 publicRouter 이동 방지                                     |                                   로그아웃 시 privateRouter 이동 방지                                   |
| :------------------------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------------------: |
| ![privateRouter](https://github.com/wowba/Wikinity/assets/87873821/972183ef-3738-425c-9506-dc4d7b1d0ed6) | ![publicRouter](https://github.com/wowba/Wikinity/assets/87873821/47618172-79df-4404-bfd2-3adaf381df6e) |

## 발생했었던 이슈

~가 발생했는데, ~로 고쳤다!

```javascript
console.log('hello, world!');
```

## 후기

후기후기-

</details>









<details>
<summary>김지민</summary>

## :thought_balloon: 채팅 주요 기능

#### 소켓 연결

#### 채팅 보내기, 채팅 받기

#### 이전 채팅 가져오기

#### 채팅 데이터 수정하기

#### 채팅 나가기

## :art: 디자인

#### 헤더
#### 채팅방 목록

## :bomb: 트러블 슈팅

:x: 오류

Duplicate atom key "userIdState". This is a FATAL ERROR in production. But it is safe to ignore this warning if it occurred because of
hot module replacement.

분명 atom은 하나인데 자꾸 이런 오류가 떴습니다.
찾아보니 Next.js에서 build를 하면 atom을 저장해두는데 이것 때문에 두개로 중복된다고 Next.js에서 판단한다는 유명한 오류였습니다.;;

:heavy_check_mark: 해결

RecoilEnv.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED = false;
.App.js 파일 상단에 추가하니 오류가 사라졌습니다!

:x: 오류

socket을 두번씩 생성되는 오류가 있었습니다. 이 때문에 소켓 connect가 제대로 이루어지지 않았습니다.

:heavy_check_mark: 해결

next.config.js 파일에서 reactStrictMode: false 를 해주었습니다.
react에서는 reactStrictMode: true이면 render가 강제적으로 두번씩 된다고 합니다!
또한 무한 소켓 연결을 막기 위해 useMemo를 사용하여 소켓을 생성해주었습니다

:x: 오류

socke을 connect 했음에도 불구하고 fetch-messages가 서버로 전송되지 않는 에러

:heavy_check_mark: 해결

setTimeout을 사용해 소켓에 요청이 들어갈때까지 요청을 보냈습니다.

:x: 오류
채팅방에서 text를 작성해 onChange 이벤트가 발생하면 상관없는 userId API를 호출하는 오류

:heavy_check_mark: 해결
userId API를 useEffect로 감싸서 의존성 배열에 instance,chatId를 줬었는데 chatId로만 의존성 배열을 변경하였습니다. 

:x: 오류
Image is missing required "src" property: 

:heavy_check_mark: 해결
소켓에서 받아오는 대화정보는 userId만 받아와서 해당 userID의 정보를 API요청으로 받아줄때
유저 이미지를 useState('')값으로 초기화를 했더니 발생한 오류였읍니다.
src 에userImage의 경로가 들어가긴 하지만 Nextjs에서 제공하는 Image태그는 src값을 절대 빈값으로 받지않아 발생는 오류였습니다. 따라서 response로 받아오는 이미지 url값이 있을때만 해당 Image 태그를 반환하게 수정하였더니 해결되었습니다









## 후기

react에서 소켓 연결은 처음이라 정말 많은 우여곡절이 있었다.:sweat_drops:  소켓 연결 시도하면서 너무 막막했지만 팀원들 덕분에 다같이 해결할 수 있었다 + 멘토님 :fire::fire:<br/>
진짜 채팅 기능 구현 못할 것 같았는데 해냈다..도와주신 팀원분들 모두 감사합니다!:+1::+1:<br/>
scss를 처음 사용해보았는데 생각보다 편리해서 좋았다 css를 상속할 수 있다는게 진짜 편리한 것 같다.<br/> 
axios를 사용해서 API 연결했는데 처음에는 에러 코드가 너무 세분화 되어있지 않아서 불편했는데 덕분에 네트워크 탭을 마스터 한 것 같아서 뿌듯하다..이제는 어떠한 네트워크 오류가 발생해도 해결할 수 있을 듯한 느낌:+1: <br/>
어찌보면 간단한 기능을 구현하는 거라고 생각했는데 생각보다 시간이 걸렸고 꽤나 어려움을 느꼈다.. 그리고 이번에도 Next.js를 제대로 활용하지 못한 느낌이라 아쉬웠다..
소켓 연결에 시간을 많이 뺏겨 SSR을 제대로 공부하고 사용할 시간적 여유가 없었어서 아쉬웠다..!
그래도 협업하는 법을 다시 한 번 알게되었고 또, 처음으로 zira를 사용해볼 수 있어서 좋았다!
하지만 아무래도 공통 컴포넌트를 개인적으로 작업하는 건 한계가 있는 것 같아서 다음 프로젝트에서는 꼭 storybook을 사용해 봐야겠다!
</details>

<!-- -------------------------- 준혁님 자리 -------------------------- -->

<details>
<summary>어준혁</summary>

## 작업 세부내용

- ~~설정.
- ~~시도.

## ~~ 기능 구현

- ~~ 할 수 있는 기능 추가.

|                                     로그인 시 publicRouter 이동 방지                                     |                                   로그아웃 시 privateRouter 이동 방지                                   |
| :------------------------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------------------: |
| ![privateRouter](https://github.com/wowba/Wikinity/assets/87873821/972183ef-3738-425c-9506-dc4d7b1d0ed6) | ![publicRouter](https://github.com/wowba/Wikinity/assets/87873821/47618172-79df-4404-bfd2-3adaf381df6e) |

## 발생했었던 이슈

~가 발생했는데, ~로 고쳤다!

```javascript
console.log('hello, world!');
```

## 후기

후기후기-

</details>

<!-- -------------------------- 지영님 자리 -------------------------- -->

<details>
<summary>윤지영</summary>

## 작업 세부내용

- ~~설정.
- ~~시도.

## ~~ 기능 구현

- ~~ 할 수 있는 기능 추가.

|                                     로그인 시 publicRouter 이동 방지                                     |                                   로그아웃 시 privateRouter 이동 방지                                   |
| :------------------------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------------------: |
| ![privateRouter](https://github.com/wowba/Wikinity/assets/87873821/972183ef-3738-425c-9506-dc4d7b1d0ed6) | ![publicRouter](https://github.com/wowba/Wikinity/assets/87873821/47618172-79df-4404-bfd2-3adaf381df6e) |

## 발생했었던 이슈

~가 발생했는데, ~로 고쳤다!

```javascript
console.log('hello, world!');
```

## 후기

후기후기-

</details>





# 🍋 소켓 기반 채팅앱

주어진 API와 소켓을 분석해 어떤 프로젝트를 진행/완성할 것인지 팀 단위로 자유롭게 결정하고 만들어보세요.  
과제 수행 및 리뷰 기간은 별도 공지를 참고하세요!

## 과제 수행 및 제출 방법

```
Y_FE_Toy2_{팀명}

E.g, Y_FE_Toy2_GYOHEON
```

1. 현재 저장소를 로컬에 클론(Clone)합니다.
1. 자신의 팀명으로 브랜치를 생성합니다.(구분 가능하도록 팀명을 꼭 파스칼케이스로 표시하세요, `git branch Y_FE_Toy2_Team13`)
1. 자신의 팀명 브랜치에서 과제를 수행합니다.
1. 과제 수행이 완료되면, 자신의 팀명 브랜치를 원격 저장소에 푸시(Push)합니다.(`main` 브랜치에 푸시하지 않도록 꼭 주의하세요, `git push origin Y_FE_Toy2_Team13`)
1. 저장소에서 `main` 브랜치를 대상으로 Pull Request 생성하면, 과제 제출이 완료됩니다!(E.g, `main` <== `Y_FE_Toy2_Team13`)
1. Pull Request 링크를 LMS로도 제출해 주셔야 합니다.
1. main 혹은 다른 사람의 브랜치로 절대 병합하지 않도록 주의하세요!
1. Pull Request에서 보이는 설명을 다른 사람들이 이해하기 쉽도록 꼼꼼하게 작성하세요!

- 과제 수행 및 제출 과정에서 문제가 발생한 경우, 바로 담당 멘토나 강사에게 얘기하세요!

- 백엔드 서버에 문제가 생겼을 경우, 바로 슬랙의 GyoHeon Lee에게 연락하세요!

## 필수 구현 사항
- [ ] `useState` 또는 `useReducer`를 활용한 상태 관리 구현
- [ ] `Sass`, `styled-component`, `emotion`, `Chakra UI`, `tailwind CSS` 등을 활용한 스타일 구현
- [ ] `react` 상태를 통한 CRUD 구현
- [ ] 상태에 따라 달라지는 스타일 구현
- [ ] `custom hook`을 통한 비동기 처리 구현
- [ ] 유저인증 시스템(로그인, 회원가입) 구현
- [ ] `jwt`등의 유저 인증 시스템 (로그인, 회원가입 기능)
- [ ] 소켓을 이용한 채팅 구현

## 선택 구현 사항
- [ ] `Next.js`를 활용한 서버 사이드 렌더링 구현
- [ ] `typescript`를 활용한 앱 구현
- [ ] `storybook`을 활용한 디자인 시스템 구현
- [ ] `jest`를 활용한 단위 테스트 구현

## 추가 사항
- api들의 응답 데이터들을 일부러 파편화 해두었습니다!
- api들 간의 데이터를 조합하여 이상적인 구조를 만들어보세요.

## 예시 프로젝트

![private-messaging-part-1-chat-ab610e9e03738ad37f7b0fb55c771087](https://github.com/KDT1-FE/Y_FE_Toy2/assets/66263916/c5247dde-2ca6-4285-a60e-8dcf23326d0e)

## API 사용법

- 모든 network 요청(Request) `headers`에 아래 정보가 꼭 포함돼야 합니다!  
- serverId는 팀마다 개별 전달됩니다.
- 확인할 수 없는 사용자나 팀의 DB 정보는 임의로 삭제될 수 있습니다!

```json
{
  "content-type": "application/json",
  "serverId": "nREmPe9B",
}
```

## 기본 데이터 구조
### user
```ts
interface User {
  id: string;
  password: string;
  name: string;
  picture: string;
  chats: string[]; // chat id만 속합니다.
}
```
### chat
```ts
interface Chat {
  id: string;
  name: string;
  isPrivate: boolean;
  users: string[];
  messages: Message[]; // message 객체가 속합니다.
  
  updatedAt: Date;
}
```
### message
```ts
interface Message {
  id: string;
  text: string;
  userId: string;

  createdAt: Date;
}
```
## 회원

### 회원가입

사용자가 `id`에 종속되어 회원가입합니다.

- 사용자 비밀번호는 암호화해 저장합니다.
- 프로필 이미지는 url or base64 형식이어야 합니다.
- 프로필 이미지는 1MB 이하여야 합니다.

```curl
curl https://fastcampus-chat.net/signup
  \ -X 'POST'
```

요청 데이터 타입 및 예시:

```ts
interface RequestBody {
  id: string // 사용자 아이디 (필수!, 영어와 숫자만)
  password: string // 사용자 비밀번호, 5자 이상 (필수!)
  name: string // 사용자 이름, 20자 이하 (필수!)
  picture?: string // 사용자 이미지(url or base64, under 1MB)
}
```

```json
{
  "id": "abcd",
  "password": "********",
  "name": "GyoHeon",
  "picture": "https://avatars.githubusercontent.com/u/66263916?v=4"
}
```

응답 데이터 타입 및 예시:

```ts
interface ResponseValue {
  message: title
}
```

```json
{
  "message": "User created"
}
```

### id 중복 체크

`id` 중복 체크를 합니다.

```curl
curl https://fastcampus-chat.net/check/id
  \ -X 'POST'
```

요청 데이터 타입 및 예시:

```ts
interface RequestBody {
  id: string // 사용자 아이디 (필수!, 영어와 숫자만)
}
```

```json
{
  "id": "abcd",
}
```

응답 데이터 타입 및 예시:

```ts
interface ResponseValue {
  isDuplicated: boolean
}
```

```json
{
  "isDuplicated": false
}
```

### 로그인

- 발급된 `accessToken`은 7일 후 만료됩니다.

```curl
curl https://fastcampus-chat.net/login
  \ -X 'POST'
```

요청 데이터 타입 및 예시:

```ts
interface RequestBody {
  id: string // 사용자 아이디 (필수!)
  password: string // 사용자 비밀번호 (필수!)
}
```

```json
{
  "id": "abcd",
  "password": "********"
}
```

응답 데이터 타입 및 예시:

```ts
interface ResponseValue {
  accessToken: string // 사용자 접근 토큰
  refreshToken: string // access token 발급용 토큰
}
```

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjlQS3I...(생략)",
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjlQS3I...(생략)"
}
```

### 인증 확인

`id` 중복 체크를 합니다.

```curl
curl https://fastcampus-chat.net/auth/me
  \ -X 'GET'
  \ -H 'Authorization: Bearer <accessToken>'
```

요청 데이터 타입 및 예시:
- 없음

응답 데이터 타입 및 예시:

```ts
interface ResponseValue {
  auth: boolean;
  user?: User;
}

interface User {
  id: string;
  name: string;
  picture: string;
}
```

```json
{
  "auth": true,
  "user": {
    "id": "test1",
    "name": "abcde",
    "picture": "https://avatars.githubusercontent.com/u/42333366?v=4"    
  }
}
```

### 토큰 재발급

```curl
curl https://fastcampus-chat.net/refresh
  \ -X 'POST'
  \ -H 'Authorization: Bearer <accessToken>'
```

요청 데이터 타입 및 예시:

```ts
interface RequestBody {
  refreshToken: string // access token 발급용 토큰
}
```

```json
{
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjlQS3I...(생략)"
}
```

응답 데이터 타입 및 예시:

```ts
interface ResponseValue {
  accessToken: string // 사용자 접근 토큰
}
```

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjlQS3I...(생략)",
}
```

### 사용자 정보 수정

- 프로필 이미지는 url or base64 형식이어야 합니다.
- 프로필 이미지는 1MB 이하여야 합니다.

```curl
curl https://fastcampus-chat.net/user
  \ -X 'PATCH'
  \ -H 'Authorization: Bearer <accessToken>'
```

요청 데이터 타입 및 예시:

```ts
interface RequestBody {
  name?: string // 새로운 표시 이름
  picture?: string // 사용자 프로필 이미지(url or base64)
}
```

```json
{
  "name": "abcde",
  "picture": "https://avatars.githubusercontent.com/u/42333366?v=4"
}
```

응답 데이터 타입 및 예시:

```ts
interface ResponseValue {
  messgae: string
}
```

```json
{
  "message": "User updated"
}
```

## 채팅
### 특정 유저 조회
- 특정 유저를 조회합니다.
```curl
curl https://fastcampus-chat.net/user?userId=${userId}
  \ -X 'GET'
  \ -H 'Authorization: Bearer <accessToken>'
```
요청 데이터 타입 및 예시:
- 없음
- 조회하고 싶은 id는 query string으로 사용합니다.

응답 데이터 타입 및 예시:
```ts
type ResponseValue = {
  user: User;
}

interface User {
  id: string;
  name: string;
  picture: string;
}
```

```json
{
  "user": {
    "id": "user1",
    "name": "lgh",
    "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
  }
}
```

### 모든 유저 조회
- 현재 존재하는 모든 유저를 조회합니다.
```curl
curl https://fastcampus-chat.net/users
  \ -X 'GET'
  \ -H 'Authorization: Bearer <accessToken>'
```
요청 데이터 타입 및 예시:
- 없음

응답 데이터 타입 및 예시:
```ts
type ResponseValue = User[]

interface User {
  id: string;
  name: string;
  picture: string;
}
```

```json
[
  {
    "id": "user1",
    "name": "lgh",
    "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
  },
  {
    "id": "user2",
    "name": "ldj",
    "picture": "https://gravatar.com/avatar/d94869409b4e94903723612a4f93a6f9?s=200&d=retro"
   }
]
```


### 채팅 생성하기

```curl
curl https://fastcampus-chat.net/chat
  \ -X 'POST'
  \ -H 'Authorization: Bearer <accessToken>'
```

요청 데이터 타입 및 예시:
```ts
interface RequestBody{
  name: string, // chat 이름
  users: string[], // 참가자들 id(자신 미포함)
  isPrivate?: boolean // 공개 비공개
}
```

```json
{
  "name": "test chat",
  "users": ["user1", "user2"]
}
```

응답 데이터 타입 및 예시:
```ts
interface ResponseValue {
  id: string,
  name: string,
  users: User[], // 자신을 포함한 참가자들 정보
  isPrivate: boolean,
  updatedAt: Date
}

interface User {
  id: string;
  name: string;
  picture: string;
}
```

```json
{
  "id": "fasgadsfdsghssdlsdafasd",
  "name": "test chat",
  "users": [
    {
      "id": "user1",
      "name": "lgh",
      "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
    },
    {
      "id": "user2",
      "name": "ldj",
      "picture": "https://gravatar.com/avatar/d94869409b4e94903723612a4f93a6f9?s=200&d=retro"
     }
  ],
  "isPrivate": false,
  "updatedAt": "2023-11-01T08:23:39.850Z"
}
```

### 모든 채팅 조회
- 현재 존재하는 모든 채팅을 조회합니다.
- isPrivate: true인 채팅방은 보이지 않습니다.

```curl
curl https://fastcampus-chat.net/chat/all
  \ -X 'GET'
  \ -H 'Authorization: Bearer <accessToken>'
```

요청 데이터 타입 및 예시:
- 없음

응답 데이터 타입 및 예시:
```ts
type ResponseValue = Chat[]

interface Chat {
  id: string;
  name: string;
  users: User[]; // 속한 유저 정보
  isPrivate: boolean;
  latestMessage: Message | null;
  updatedAt: Date;
}

interface User {
  id: string;
  name: string;
  picture: string;
}

interface Message {
  id: string;
  text: string;
  userId: string;
  createAt: Date;
}
```

```json
[
  {
    "id": "f189ab25-5644-4d72-bd7c-0170ee9c8ede",
    "name": "chat room 1",
    "users": [
    {
      "id": "user1",
      "name": "lgh",
      "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
    },
    {
      "id": "user2",
      "name": "ldj",
      "picture": "https://gravatar.com/avatar/d94869409b4e94903723612a4f93a6f9?s=200&d=retro"
    }
  ],
    "isPrivate": false,
    "updatedAt": "2023-10-31T13:18:38.216Z",
    "latestMessage": null
  },
  {
    "id": "f189ab25-5644-4d72-bd7c-0170ee9c8edj",
    "name": "chat room 2",
    "users": [
    {
      "id": "user1",
      "name": "lgh",
      "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
    },
    {
      "id": "user2",
      "name": "ldj",
      "picture": "https://gravatar.com/avatar/d94869409b4e94903723612a4f93a6f9?s=200&d=retro"
    }
  ],
    "isPrivate": false,
    "updatedAt": "2023-10-31T15:18:38.216Z",
    "latestMessage": {
      "id": "8f7f67bb-f1ab-4792-9678-0b8546adcb6f",
      "text": "testtest444",
      "userId": "test:test6",
      "createdAt": "2023-11-06T11:15:50.588+00:00"
    }
  }
]
```

### 나의 채팅 조회
```curl
curl https://fastcampus-chat.net/chat
  \ -X 'GET'
  \ -H 'Authorization: Bearer <accessToken>'
```
- 내가 속한 모든 채팅을 조회합니다.
- isPrivate: true인 채팅방도 모두 보이게 됩니다.

요청 데이터 타입 및 예시:
- 없음

응답 데이터 타입 및 예시:
```ts
type ResponseValue = Chat[]

interface Chat {
  id: string;
  name: string;
  users: User[]; // 속한 유저 id
  isPrivate: boolean;
  latestMessage: Message | null;
  updatedAt: Date;
}

interface User {
  id: string;
  name: string;
  picture: string;
}

interface Message {
  id: string;
  text: string;
  userId: string;
  createAt: Date;
}
```

```json
[
  {
    "id": "f189ab25-5644-4d72-bd7c-0170ee9c8ede",
    "name": "chat room 1",
    "users": [
    {
      "id": "user1",
      "name": "lgh",
      "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
    },
    {
      "id": "user2",
      "name": "ldj",
      "picture": "https://gravatar.com/avatar/d94869409b4e94903723612a4f93a6f9?s=200&d=retro"
    }
  ],
    "isPrivate": true,
    "updatedAt": "2023-10-31T13:18:38.216Z",
    "latestMessage": null
  },
  {
    "id": "f189ab25-5644-4d72-bd7c-0170ee9c8edj",
    "name": "chat room 2",
    "users": [
      {
        "id": "user1",
        "name": "lgh",
        "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
      },
      {
        "id": "user2",
        "name": "ldj",
        "picture": "https://gravatar.com/avatar/d94869409b4e94903723612a4f93a6f9?s=200&d=retro"
      }
    ],
    "isPrivate": false,
    "updatedAt": "2023-10-31T15:18:38.216Z",
    "latestMessage": {
      "id": "8f7f67bb-f1ab-4792-9678-0b8546adcb6f",
      "text": "testtest444",
      "userId": "test:test6",
      "createdAt": "2023-11-06T11:15:50.588+00:00"
    }
  }
]
```

## 채팅 참여하기

```curl
curl https://fastcampus-chat.net/chat/participate
  \ -X 'PATCH'
  \ -H 'Authorization: Bearer <accessToken>'
```

요청 데이터 타입 및 예시:
```ts
interface RequestBody {
  chatId: string;
}
```

```json
{
  "chatId": "f189ab25-5644-4d72-bd7c-0170ee9c8ede"
}
```

응답 데이터 타입 및 예시:
```ts
interface ResponseValue{
  id: string;
  name: string;
  users: User[]; // 속한 유저 id
  isPrivate: boolean;
  updatedAt: Date;
}

interface User {
  id: string;
  name: string;
  picture: string;
}
```

```json
{
  "id": "f189ab25-5644-4d72-bd7c-0170ee9c8ede",
  "name": "chat room 1",
  "users": [
    {
      "id": "user1",
      "name": "lgh",
      "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
    },
    {
      "id": "user2",
      "name": "ldj",
      "picture": "https://gravatar.com/avatar/d94869409b4e94903723612a4f93a6f9?s=200&d=retro"
    }
  ],
  "isPrivate": true,
  "updatedAt": "2023-10-31T13:18:38.216Z"
}
```

## 채팅 나가기

```curl
curl https://fastcampus-chat.net/chat/leave
  \ -X 'PATCH'
  \ -H 'Authorization: Bearer <accessToken>'
```

요청 데이터 타입 및 예시:
```ts
interface RequestBody {
  chatId: string;
}
```

```json
{
  "chatId": "f189ab25-5644-4d72-bd7c-0170ee9c8ede"
}
```

응답 데이터 타입 및 예시:
```ts
interface ResponseValue {
  message: string;
}
```

```json
{
  "message": "Leave success"
}
```

## 채팅 초대하기

```curl
curl https://fastcampus-chat.net/chat/invite
  \ -X 'PATCH'
  \ -H 'Authorization: Bearer <accessToken>'
```

요청 데이터 타입 및 예시:
```ts
interface RequestBody {
  chatId: string;
  users: string[]; // 초대할 유저 id
}
```

```json
{
  "chatId": "f189ab25-5644-4d72-bd7c-0170ee9c8ede",
  "users": ["user1", "user2"]
}
```

응답 데이터 타입 및 예시:
```ts
interface ResponseValue{
  id: string;
  name: string;
  users: User[]; // 속한 유저 정보
  isPrivate: boolean;
  updatedAt: Date;
}

interface User {
  id: string;
  name: string;
  picture: string;
}
```

```json
{
  "id": "f189ab25-5644-4d72-bd7c-0170ee9c8ede",
  "name": "chat room 1",
  "users": [
    {
      "id": "user1",
      "name": "lgh",
      "picture": "https://gravatar.com/avatar/c274467c5ef4fe381b154a20c5e7ce26?s=200&d=retro"
    },
    {
      "id": "user2",
      "name": "ldj",
      "picture": "https://gravatar.com/avatar/d94869409b4e94903723612a4f93a6f9?s=200&d=retro"
    }
  ],
  "isPrivate": true,
  "updatedAt": "2023-10-31T13:18:38.216Z"
}
```

# Socket
- socket.io 의 사용을 추천드립니다.
- Socket 연결시에도 headers는 유지해야 합니다.
## 기본 연결
```ts
io(`https://fastcampus-chat.net/chat?chatId=${chatId}`,
  {
    extraHeaders: {
      Authorization: "Bearer <accessToken>",
      serverId: "test",
    },
  })
```

## emit Event(client -> server)
### example
```ts
socket.emit('message-to-server', text)
```
### message-to-server
- 같은 방에 있는 사람들에게 메세지를 전달합니다.

요청 데이터
```ts
type RequestData: string;
```
### fetch-messages
- 이전 대화 목록을 불러옵니다.
- `messages-to-client`로 데이터를 받을 수 있습니다.

요청 데이터
- 없음
### users
- 접속 상태인 유저 목록을 불러옵니다.
- `users-to-client`로 데이터를 받을 수 있습니다.

요청 데이터
- 없음 

## on Event(server -> client)
### example
```ts
socket.on('message-to-client', (messageObject) => {
  console.log(messageObject);
})
```
### message-to-client
- 같은 방에 있는 사람들에게 메세지를 전달합니다.

응답 데이터
```ts
interface ResponseData {
  id: string;
  text: string;
  userId: string; // 메세지를 보낸 사람의 id
  createdAt: Date;
}
```
### messages-to-client
- 이전 대화 목록을 불러옵니다.

응답 데이터
```ts
interface Message {
  id: string;
  text: string;
  userId: string; // 메세지를 보낸 사람의 id
  createdAt: Date;
}

interface ResponseData {
  messages: Message[];
}
```
### join
- 같은 방에 새로운 사람이 들어오면 모든 유저의 정보를 다시 받습니다.

응답 데이터
```ts
interface ResponseData {
  users: string[]; // 참여자들 id
  joiners: string[]; // 새로운 참여자 id
}
```
### leave
- 같은 방에 사람이 나가면 모든 유저의 정보를 다시 받습니다.

응답 데이터
```ts
interface ResponseData {
  users: string[]; // 참여자들 id
  leaver: string; // 나간 사용자 id
}
```
### new-chat
- 새로운 대화방이 생긴 경우 (not private) 서버(팀에서 사용하는 serverId)의 참여자들에게 이를 전달합니다.

응답 데이터
```ts
interface ResponseData {
  id: string;
  name: string;
  users: string[]; // 참여자들 id
  isPrivate: boolean;
  updatedAt: Date;
}
```

### users-to-client
- 접속 상태인 유저 목록을 불러옵니다.

응답 데이터
```ts
interface ResponseData {
  user: string[]; // 참가자들 id
}
```

## server 연결
```ts
io(`https://fastcampus-chat.net/server`,
  {
    extraHeaders: {
      Authorization: "Bearer <accessToken>",
      serverId: "test",
    },
  })
```

## emit Event(client -> server)
### example
```ts
socket.emit('users-server')
```
### users-server
- 같은 serverId를 사용하는 online 사용자를 불러옵니다.
- `users-server-to-client`로 데이터를 받을 수 있습니다.

요청 데이터
- 없음

## on Event(server -> client)
### example
```ts
socket.on('message-to-client', (messageObject) => {
  console.log(messageObject);
})
```

### users-server-to-client
- 같은 serverId를 사용하는 접속 상태인 유저 목록을 불러옵니다.

응답 데이터
```ts
interface ResponseData {
  user: string[]; // 참가자들 id
}
```
